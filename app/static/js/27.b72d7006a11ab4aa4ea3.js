webpackJsonp([27],{"8UaT":function(e,t,i){e.exports=i.p+"static/img/ticket-Bg1.8d68245.png"},"Ou+g":function(e,t){},hVMy:function(e,t){},nDqC:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={name:"ticketBook",components:{Header:i("FCAx").a},data:function(){return{title:"创建订单",isback:!0,color:"#FF6400",info:{},friends:[],check:[],ID:"",userTime:null,price:0,checked:!1,userMobile:"",value:1,show2:!1}},methods:{init:function(){var e=this,t=this.$route.params.id;this.id=t,this.$http.post("/appServiceOrder/voucher/writeinformation",{productId:t}).then(function(t){"success"==t.msg&&(e.info=t.data,t.data.mobile&&(e.userMobile=t.data.mobile))})},queryGeneralContact:function(){var e=this;this.$http.post("/appServiceOrder/queryGeneralContact").then(function(t){if("success"==t.msg){e.friends=t.data,e.check=[];for(var i=0;i<t.data.length;i++)e.check.push(!1)}})},queryTicketPrice:function(){var e=this;this.$http.post("/appServiceOrder/queryTicketPrice",{productId:this.id,useTime:this.userTime||(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate()}).then(function(t){"success"==t.msg&&(e.price=t.data.price)})},checkFriend:function(e){for(var t=0;t<this.check.length;t++)this.check=!1;this.check[e]=!0},showpopup:function(){this.show=!0},confirm:function(e){this.userTime=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate(),this.show=!1,this.queryTicketPrice()},cancel:function(){this.show=!1},detail:function(){this.show2=!0},add:function(){this.showadd=!0},beforeClose:function(e,t){"confirm"===e?setTimeout(t,1e3):t()},submit:function(){var e=this;if(this.value>0)if(11==this.userMobile.length){var t={buyNumber:this.value,productId:this.id};this.$http.post("/appServiceOrder/voucher/submit",t).then(function(t){"success"==t.msg&&e.$router.push({name:"payment",params:{id:t.data.orderId,type:2}})})}else this.$toast("请填写正确手机号");else this.$toast("购买数量不能小于1")}},computed:{},created:function(){this.init()},mounted:function(){}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ticketBook",attrs:{id:"foodbook"}},[s("div",{staticClass:"topBar"},[s("Header",{attrs:{title:e.title,color:e.color}})],1),e._v(" "),s("div",{staticStyle:{width:"100%",height:".92rem"}}),e._v(" "),s("router-link",{staticClass:"detail",staticStyle:{background:"#FF6400"},attrs:{to:1==e.info.businessType?{name:"scenicDetail",params:{id:e.info.businessNumber}}:{name:"grangedetail",params:{id:e.info.businessNumber}},tag:"div"}},[s("img",{attrs:{src:i("8UaT"),alt:""}}),e._v(" "),s("div",[s("h3",[e._v(e._s(e.info.businessName))]),e._v(" "),s("p",[e._v(e._s(e.info.voucherName))]),e._v(" "),s("p",{staticStyle:{color:"#4FC874",border:".01rem solid #4FC874",display:"inline-block","line-height":"1.6",padding:"0  .1rem","border-radius":".08rem"}},[e._v(e._s(e.info.abolitionRules))]),e._v(" "),s("p",{staticStyle:{color:"#f00","font-size":".32rem","font-weight":"600"}},[e._v("￥"+e._s(e.info.voucherPrice)+"元")])])]),e._v(" "),s("div",{staticClass:"item"},[s("div",{staticClass:"mount"},[s("span",[e._v("购买数量")]),e._v(" "),s("van-stepper",{staticClass:"pp",model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),s("div",{staticClass:"agreement"},[s("van-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("我同意该协议")])],1)]),e._v(" "),s("div",{staticClass:"bottom clear",staticStyle:{position:"fixed",bottom:"0",left:"0","font-size":".26rem",color:"#606063"}},[s("div",[s("span",[e._v("总价")]),e._v(" "),s("span",{staticClass:"price"},[e._v("￥"),s("span",{staticStyle:{"font-size":".3rem"}},[e._v(e._s(e.info.voucherPrice*e.value))]),e._v(" 元")])]),e._v(" "),s("p",[s("button",{staticStyle:{color:"#606063"},on:{click:e.detail}},[e._v("明细 "),s("i",{staticClass:"iconfont icon-shangsanjiaoxiangshangmianxing"})]),e._v(" "),e.checked&&e.value>0?s("span",{on:{click:e.submit}},[e._v("\n          提交订单\n        ")]):s("span",{staticStyle:{background:"#B2B2B2"}},[e._v("\n          提交订单\n        ")])])]),e._v(" "),s("van-popup",{attrs:{position:"bottom"},model:{value:e.show2,callback:function(t){e.show2=t},expression:"show2"}},[s("div",{staticStyle:{"line-height":".8rem","fon-size":".26rem",padding:"0 .2rem","box-sizing":"border-box",color:"#1e1e1e","background-color":"#e3e3e4"}},[e._v("价格明细")]),e._v(" "),s("div",{staticStyle:{"line-height":".8rem","fon-size":".26rem",padding:"0 .2rem","box-sizing":"border-box",color:"#1e1e1e"}},[s("p",{staticStyle:{float:"left"}},[e._v("美食代金券")]),e._v(" "),s("p",{staticStyle:{float:"right"}},[e._v(e._s(e.info.voucherPrice)+"元 * "+e._s(e.value)+"张")])])])],1)},staticRenderFns:[]};var n=i("VU/8")(s,o,!1,function(e){i("hVMy"),i("Ou+g")},"data-v-35e4610f",null);t.default=n.exports}});