webpackJsonp([32],{VOL7:function(t,e){},hEJH:function(t,e){},zROL:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("7qok"),a={name:"scenicDetailcomment",components:{Header:s("56oB").a},data:function(){return{active:["住宿","美食","游玩"],num:1,value:0,message:"",autosize:{maxHeight:300,minHeight:200},title:"写点评",isback:!0,imglist:[],landid:null,useid:null}},methods:{uploadimg:function(t){var e=this,s=t.target.files[0],a=s.size/1024/1024,n=s.name.substring(s.name.lastIndexOf(".")+1,s.name.length).toLocaleLowerCase(),o=new FormData,l=(new Date).getTime()+Math.floor(999999*Math.random())+"."+n;if(o.append("key",l),"jpg"!=n&&"bmp"!=n&&"png"!=n&&"jpeg"!=n)return this.$toast("上传图片格式不正确"),!1;if(a>10)return this.$toast("上传的图片不得大于10MB"),!1;var c=i.a.genUpToken(2,l);o.append("token",c),o.append("file",s);var u=i.a.niuUrl[1];this.$http.postImg("https://upload.qiniu.com/",o,null,null,{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}).then(function(t){e.imglist.push(u+t.key),console.log(e.imglist)})},tab:function(t){this.num=t+1,console.log(this.num)},delIMg:function(t){this.imglist.splice(t,1)},rateChange:function(){console.log(this.value)},submit:function(){var t=this,e=this.imglist.join(",");if(console.log(e),console.log(this.message),""!=this.message)if(0!=this.value){var s={commentType:this.num,landSpaceId:this.landid,starLevel:this.value,comment:this.message,images:e,userId:this.useid};this.$http.post("appServiceGrange/landComment",s).then(function(e){"success"==e.msg?(t.$toast("评论成功"),setTimeout(function(){t.$router.go(-1)})):t.$toast(e.info)})}else this.$toast("请评分");else this.$toast("请输入评论内容")}},computed:{},created:function(){this.landid=this.$route.params.id,this.useid=JSON.parse(localStorage.getItem("userInfo")).userId},mounted:function(){}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"scenicDetailcomment"},[s("div",{staticClass:"topBar"},[s("Header",{attrs:{title:t.title,isback:t.isback}})],1),t._v(" "),s("div",{staticStyle:{height:"0.9rem"}}),t._v(" "),s("div",{staticClass:"top clear"},t._l(t.active,function(e,i){return s("p",{class:{orange:t.num==i+1},attrs:{keys:i},on:{click:function(e){t.tab(i)}}},[t._v(t._s(e))])})),t._v(" "),s("div",{staticClass:"rates"},[s("span",[t._v("*")]),t._v("总体评分"),s("van-rate",{on:{change:t.rateChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t._v(" "),s("div",{staticClass:"comment"},[s("van-cell-group",[s("van-field",{attrs:{label:"评价",type:"textarea",placeholder:"请输入您的评价内容",autosize:t.autosize,required:""},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)],1),t._v(" "),s("div",{staticClass:"upload"},[s("p",[t._v("上传图片")]),t._v(" "),s("div",{staticClass:"buttonimg"},[t._l(t.imglist,function(e,i){return s("div",[s("img",{attrs:{src:e,alt:""}}),t._v(" "),s("i",{on:{click:function(e){t.delIMg(i)}}},[t._v("删除")])])}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.imglist.length<=3,expression:"imglist.length<=3"}]},[s("input",{attrs:{type:"file"},on:{change:function(e){t.uploadimg(e)}}})])],2)]),t._v(" "),s("div",{staticClass:"bottom",on:{click:t.submit}},[t._v("发 布")])])},staticRenderFns:[]};var o=s("VU/8")(a,n,!1,function(t){s("hEJH"),s("VOL7")},"data-v-ee7bbd28",null);e.default=o.exports}});