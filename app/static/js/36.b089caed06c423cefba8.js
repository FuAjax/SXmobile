webpackJsonp([36],{M4GF:function(e,t,a){e.exports=a.p+"static/img/ticket-Bg.454d7b9.png"},YnfZ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={name:"innBook",data:function(){return{userName:"",userCard:"",userPassword:"",showPeople:!1,showPeopleList:!1,isback:!0,title:"住宿预订",show:!1,currentDate:new Date,currentDate2:new Date,minDate:new Date,value1:new Date,value2:new Date,date1:!1,date2:!1,days:1,show2:!1,abolitionRules:"",address:"",areaName:"",areaRestful:"",bedType:"",breakfastNumber:"",businessLogoUrl:"",businessName:"",businessNumber:"",businessType:2,productName:"",stayNumber:2,telephone:"",drawback:"",priceDetail:"",totalPrice:"",showadd:!1,mobile:"",idCard:"",username:"",info:[],activeIndex:0,changeRed:0,UserName:"",color:"#FF6400",contactName:"",contactMobile:"",contactIdcard:"",phone:"",card:"",beforeClose:null}},methods:{showPopup:function(e){1==e?(this.show=!0,this.date2=!1,this.date1=!0):2==e&&(this.show=!0,this.date2=!0,this.date1=!1)},confirm2:function(e){var t=this;this.value2=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate(),console.log(this.value2);var a=e.getDate(),s=e.getDate()+1;a<10&&(a="0"+a),s<10&&(s="0"+s),this.value2=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+s,this.show=!1,""!=this.value1&&this.DateDiff(this.value1,this.value2);var o=this.value1,i=this.value2,n=this.$route.params.id,r=JSON.parse(localStorage.getItem("userInfo"));this.$http.post("appServiceOrder/returnOrderInfo",{userId:r,productId:n,checkinTime:o,checkoutTime:i}).then(function(e){console.log(e),t.drawback=e.data.drawback,t.priceDetail=e.data.priceDetail,t.totalPrice="￥"+e.data.totalPrice+"元"}),init()},confirm:function(e){var t=this;this.value1=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate(),console.log(this.value2);var a=e.getDate(),s=e.getDate()+1;a<10&&(a="0"+a),s<10&&(s="0"+s),this.value1=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+s,this.show=!1,""!=this.value1&&this.DateDiff(this.value1,this.value2);var o=this.value1,i=this.value2,n=this.$route.params.id,r=JSON.parse(localStorage.getItem("userInfo"));this.$http.post("appServiceOrder/returnOrderInfo",{userId:r,productId:n,checkinTime:o,checkoutTime:i}).then(function(e){console.log(e),t.drawback=e.data.drawback,t.priceDetail=e.data.priceDetail,t.totalPrice="￥"+e.data.totalPrice+"元"}),init()},cancel:function(){this.show=!1},DateDiff:function(e,t){var a,s,o,i;a=e.split("-"),s=new Date(a[1]+"-"+a[2]+"-"+a[0]),a=t.split("-"),o=new Date(a[1]+"-"+a[2]+"-"+a[0]),i=parseInt(Math.abs(s-o)/1e3/60/60/24),this.days=i},detail:function(){this.show2=!0},init:function(){var e=this,t=this.value1,a=this.value2;t=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),a=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+(a.getDate()+1),console.log(a);var s=JSON.parse(localStorage.getItem("userInfo")),o=this.$route.params.id;console.log(o),this.$http.post("appServiceOrder/stay/writeinformation",{productId:o,userId:s}).then(function(t){console.log(t.data),e.productName=t.data.productName,e.businessLogoUrl=t.data.businessLogoUrl,e.abolitionRules=t.data.abolitionRules,e.telephone=t.data.telephone,e.areaName=t.data.areaName,e.bedType=t.data.bedType,e.businessName=t.data.businessName,e.breakfastNumber=t.data.breakfastNumber}),this.$http.post("appServiceOrder/queryGeneralContact",{productId:o,userId:s}).then(function(t){console.log(t),e.info=t.data}),this.$http.post("appServiceOrder/returnOrderInfo",{userId:s,productId:o,checkinTime:t,checkoutTime:a}).then(function(t){console.log(t),e.drawback=t.data.drawback,e.priceDetail=t.data.priceDetail,e.totalPrice="￥"+t.data.totalPrice+"元"})},toActive:function(e){this.activeIndex=e,this.changeRed=e},submit:function(){for(var e=this,t=/^(([a-zA-Z+\.?\·?a-zA-Z+]{2,30}$)|([\u4e00-\u9fa5+\·?\u4e00-\u9fa5+]{2,30}$))/,a=/^1([38][0-9]|4[579]|5[0-3,5-9]|6[6]|7[0135678]|9[89])\d{8}$/,s=/^(^[1-9]\d{5}[1-9]\d{3}(((0[2])([0|1|2][0-8])|(([0-1][1|4|6|9])([0|1|2][0-9]|[3][0]))|(((0[1|3|5|7|8])|(1[0|2]))(([0|1|2]\d)|3[0-1]))))((\d{4})|\d{3}[Xx])$)$/,o=document.getElementsByClassName("userNAME"),i=document.getElementsByClassName("userPHONE"),n=document.getElementsByClassName("userCARD"),r=[],l=[],c=[],u=0;u<o.length;u++)r.push(o[u].value);console.log(r);for(var d=0;d<i.length;d++)l.push(i[d].value);console.log(l);for(var v=0;v<n.length;v++)c.push(n[v].value);console.log(c);for(v=0;v<o.length;v++){if(!t.test(o.item(v).value))return this.$toast("请输入正确姓名"),!1;for(var p=0;p<i.length;p++)if(a.test(i.item(p).value))for(var h=0;h<n.length;h++)if(s.test(n.item(h).value)){var m,f,b=o.item(0).value,g=i.item(0).value,_=n.item(0).value;m=this.value1,f=this.value2;var w=this.$route.params.id;this.$toast("预订成功"),this.$http.post("appServiceOrder/stay/submit",{userId:1,productId:w,occupantsName:b,occupantsMobile:g,occupantsIdcard:_,checkoutTime:f,checkinTime:m}).then(function(t){"请求成功"==t.info&&(e.$toast("预订成功"),e.$router.push({name:"inntoConfirm",params:{id:t.data.orderId,occupantsIdcard:r,occupantsMobile:l,occupantsName:c,checkoutTime:f,checkinTime:m}}))})}else this.$toast("请输入正确证件号码");else this.$toast("请输入正确手机号码")}},addPeople:function(){this.showPeople=!0,this.showPeopleList=!0},beforeCloseList:function(e,t){var a=JSON.parse(localStorage.getItem("userInfo")).userId,s="";if("confirm"===e){setTimeout(t,0);var o=this.info;this.info.forEach(function(e,t){s=e.id}),this.userName?this.userPassword?this.userCard?o.push({contactIdcard:this.userCard,contactMobile:this.userPassword,contactName:this.userName,fuserId:a,id:s+1}):this.$toast("请输入正确证件号码"):this.$toast("请输入正确手机号码"):this.$toast("请输入正确姓名"),console.log(o)}else t()}},computed:{minDate2:function(){return""==this.value?void 0:this.currentDate}},created:function(){this.init();var e="",t="";!function(a){var s=new Date;s.setDate(s.getDate()+a);var o=s.getFullYear(),i=s.getMonth()+1;i<10&&(i="0"+i);var n=s.getDate(),r=s.getDate()+1;n<10&&(n="0"+n),r<10&&(r="0"+r),e=o+"-"+i+"-"+n,t=o+"-"+i+"-"+r}(0),this.value1=e,this.value2=t},mounted:function(){},components:{Header:a("56oB").a}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"topBar"},[s("Header",{attrs:{title:e.title,isback:e.isback}})],1),e._v(" "),s("div",{staticClass:"innBook"},[s("div",{staticClass:"topBar"},[s("Header",{attrs:{title:e.title,isback:e.isback,color:e.color}})],1),e._v(" "),s("div",{staticClass:"top"},[s("img",{attrs:{src:a("M4GF"),alt:""}}),e._v(" "),s("div",{staticClass:"content"},[s("van-row",{attrs:{gutter:"10"}},[s("van-col",{attrs:{span:"7"}},[s("router-link",{attrs:{to:""}},[s("img",{attrs:{src:e.businessLogoUrl,alt:""}})])],1),e._v(" "),s("van-col",{attrs:{span:"17"}},[s("p",[e._v(e._s(e.businessName)+" "+e._s(e.productName))]),e._v(" "),s("p",[e._v(e._s(e.value1)+"---"+e._s(e.value2)+" 共"+e._s(e.days)+"晚")]),e._v(" "),s("p",[e._v(e._s(e.bedType)+"|"+e._s(2==e.breakfastNumber?"双份早餐":1==e.breakfastNumber?"单份早餐":0==e.breakfastNumber?"无早餐":""))]),e._v(" "),s("span",[e._v(e._s(e.abolitionRules))])])],1)],1)]),e._v(" "),s("div",{staticClass:"separate"}),e._v(" "),s("div",{staticClass:"datapicker clear"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.value1,expression:"value1"}],attrs:{type:"text",readonly:"",placeholder:"请选择日期"},domProps:{value:e.value1},on:{click:function(t){e.showPopup(1)},input:function(t){t.target.composing||(e.value1=t.target.value)}}}),e._v(" "),s("span",[e._v("入住")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.value2,expression:"value2"}],attrs:{type:"text",readonly:"",placeholder:"请选择日期",disabled:""==this.value1},domProps:{value:e.value2},on:{click:function(t){e.showPopup(2)},input:function(t){t.target.composing||(e.value2=t.target.value)}}}),e._v(" "),s("span",[e._v("离店")]),e._v(" "),s("p",[e._v("共"+e._s(e.days)+"晚")])]),e._v(" "),s("div",{staticClass:"separate"}),e._v(" "),s("div",{staticClass:"mount"},[s("h3",[e._v("入住人信息")]),e._v(" "),s("p",[e._l(e.info,function(t,a){return s("span",{class:{red:e.changeRed==a},on:{click:function(t){e.toActive(a)}}},[e._v(e._s(t.contactName)+" ")])}),e._v(" "),s("span",{on:{click:e.addPeople}},[e._v("添加入住人")])],2)]),e._v(" "),e._l(e.info,function(t,a){return s("ul",{directives:[{name:"show",rawName:"v-show",value:e.activeIndex===a,expression:"activeIndex===index"}],staticClass:"peoplelist"},[s("li",[s("span",[e._v("入住人：")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.contactName,expression:"i.contactName"}],staticClass:"userNAME",attrs:{type:"text",placeholder:t.contactName,value:""},domProps:{value:t.contactName},on:{input:function(a){a.target.composing||e.$set(t,"contactName",a.target.value)}}})]),e._v(" "),s("li",[s("span",[e._v("手机 :")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.contactMobile,expression:"i.contactMobile"}],staticClass:"userPHONE",attrs:{type:"text",placeholder:t.contactMobile,value:""},domProps:{value:t.contactMobile},on:{input:function(a){a.target.composing||e.$set(t,"contactMobile",a.target.value)}}})]),e._v(" "),s("li",[s("span",[e._v("证件号码：")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.contactIdcard,expression:"i.contactIdcard"}],staticClass:"userCARD",attrs:{type:"text",placeholder:t.contactIdcard,value:""},domProps:{value:t.contactIdcard},on:{input:function(a){a.target.composing||e.$set(t,"contactIdcard",a.target.value)}}})])])}),e._v(" "),s("van-dialog",{attrs:{"show-cancel-button":"","before-close":e.beforeCloseList},model:{value:e.showPeopleList,callback:function(t){e.showPeopleList=t},expression:"showPeopleList"}},[s("van-field",{attrs:{label:"入住人",placeholder:"请输入入住人"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),e._v(" "),s("van-field",{attrs:{label:"手机号",placeholder:"请输入手机号"},model:{value:e.userPassword,callback:function(t){e.userPassword=t},expression:"userPassword"}}),e._v(" "),s("van-field",{attrs:{label:"证件号",placeholder:"请输入证件号"},model:{value:e.userCard,callback:function(t){e.userCard=t},expression:"userCard"}})],1),e._v(" "),s("div",{staticClass:"separate"}),e._v(" "),s("div",{staticClass:"return"},[s("h3",[e._v("退改政策")]),e._v(" "),s("div",[e._v("\n        "+e._s(e.drawback)+"\n      ")])]),e._v(" "),s("div",{staticClass:"bottom clear"},[s("div",[s("span",[e._v("总价")]),e._v(" "),s("span",{staticClass:"price"},[e._v(" "+e._s(e.totalPrice))])]),e._v(" "),s("p",[s("button",{on:{click:e.detail}},[e._v("明细 "),s("i",{staticClass:"iconfont icon-shangsanjiaoxiangshangmianxing"})]),e._v(" "),s("span",{on:{click:e.submit}},[e._v("\n        提交订单\n      ")])])]),e._v(" "),s("van-popup",{attrs:{position:"bottom"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e.date1?s("van-datetime-picker",{attrs:{type:"date","min-date":e.minDate},on:{confirm:e.confirm,cancel:e.cancel},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}}):e._e(),e._v(" "),e.date2?s("van-datetime-picker",{attrs:{type:"date","min-date":e.minDate2},on:{confirm:e.confirm2,cancel:e.cancel},model:{value:e.currentDate2,callback:function(t){e.currentDate2=t},expression:"currentDate2"}}):e._e()],1),e._v(" "),s("van-popup",{staticClass:"bottom2",attrs:{position:"bottom"},model:{value:e.show2,callback:function(t){e.show2=t},expression:"show2"}},[s("div",{staticClass:"title"},[e._v("价格明细")]),e._v(" "),s("div",{staticClass:"houseprice"},[s("p",[e._v("房费")]),e._v(" "),s("div",[e._v(e._s(e.priceDetail))])])]),e._v(" "),s("van-dialog",{attrs:{"show-cancel-button":"","before-close":e.beforeClose,title:"联系人"},model:{value:e.showadd,callback:function(t){e.showadd=t},expression:"showadd"}},[s("van-field",{attrs:{label:"姓名",placeholder:"请输入您的真实姓名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),s("van-field",{attrs:{type:"password",label:"证件号",placeholder:"请输入您的身份证号"},model:{value:e.idCard,callback:function(t){e.idCard=t},expression:"idCard"}}),e._v(" "),s("van-field",{attrs:{label:"手机号",placeholder:"请输入手机号"},model:{value:e.mobile,callback:function(t){e.mobile=t},expression:"mobile"}})],1)],2)])},staticRenderFns:[]};var i=a("VU/8")(s,o,!1,function(e){a("wKqp")},"data-v-8908323c",null);t.default=i.exports},wKqp:function(e,t){}});