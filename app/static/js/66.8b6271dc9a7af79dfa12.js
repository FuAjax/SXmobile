webpackJsonp([66],{"0hMJ":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("GgDs"),s={init:function(){var t=this,e=this.$route.params.id,a=JSON.parse(localStorage.getItem("userInfo"));this.$http.post("appServiceFarmhouse/getVillageDetail",{villageNumber:e,userId:a}).then(function(e){t.landList=e.data.getNearByVillage,t.foodList=e.data.getFoodsList,t.playList=e.data.getPlayList,t.stayList=e.data.getStayList,t.latitude=e.data.detail.latitude,t.longitude=e.data.detail.longitude,t.villageName=e.data.detail.villageName,t.detail=e.data.detail,t.setmap()})},setmap:function(t){var e=this;function a(t,e,a,i){this._point=t,this._text=e,this._id=a,this._index=i}if(this.map=new BMap.Map("allmap"),this.map.centerAndZoom(new BMap.Point(this.longitude,this.latitude),11),this.map.enableScrollWheelZoom(!0),this.map.disableDragging(),a.prototype=new BMap.Overlay,a.prototype.initialize=function(t){this._map=t;var e=this._div=document.createElement("div");e.className="overlay",e.style.position="absolute",e.style.zIndex=BMap.Overlay.getZIndex(this._point.lat),e.style.padding="2px",e.style.MozUserSelect="none",e.style.fontSize="12px";var a=this._arrow=document.createElement("div");a.className="map-arrow",a.style.position="absolute",a.style.width="0px",a.style.height="0px",a.style.top="42px",a.style.left="18px",a.style.border="10px transparent solid",a.style.borderTopColor="#ff9900",e.appendChild(a);var i=this._a=document.createElement("a");return i.className="map-content",i.style.backgroundColor="#ff9900",i.style.borderRadius="5px",i.style.padding="5px",i.style.color="white",i.style.textDecoration="none",i.style.height="30px",i.style.whiteSpace="nowrap",i.style.display="inline-block",e.appendChild(i),i.appendChild(document.createTextNode(this._text)),t.getPanes().labelPane.appendChild(e),e},a.prototype.draw=function(){var t=this._map.pointToOverlayPixel(this._point);this._div.style.left=t.x-parseInt(this._arrow.style.left)+"px",this._div.style.top=t.y-30+"px"},0==this.changeRed)if(this.foodList)this.foodList.forEach(function(t,i){var s=new a(new BMap.Point(t.longitude,t.latitude),t.grangeName+t.fstreetName,t.id,i);e.map.addOverlay(s);var n=document.getElementsByClassName("overlay"),o=e;n[i].onclick=function(){console.log(t.grangeNumber),o.$router.push({name:"grangedetail",params:{id:t.grangeNumber}})}});else{var i=new a(new BMap.Point(this.farmhouseNum.longitude,this.farmhouseNum.latitude),this.farmhouseNum.villageName+this.farmhouseNum.count+"套",this.farmhouseNum.id);this.map.addOverlay(i)}if(1==this.changeRed)if(this.stayList)this.stayList.forEach(function(t,i){var s=new a(new BMap.Point(t.longitude,t.latitude),t.grangeName+t.fstreetName,t.id,i);e.map.addOverlay(s);var n=document.getElementsByClassName("overlay"),o=e;n[i].onclick=function(){console.log(t.grangeNumber),o.$router.push({name:"grangedetail",params:{id:t.grangeNumber}})}});else{var s=new a(new BMap.Point(this.farmhouseNum.longitude,this.farmhouseNum.latitude),this.farmhouseNum.villageName+this.farmhouseNum.count+"套",this.farmhouseNum.id);this.map.addOverlay(s)}if(2==this.changeRed)if(this.playList)this.playList.forEach(function(t,i){console.log(t);var s=new a(new BMap.Point(t.longitude,t.latitude),t.grangeName+t.grangeName,t.id,i);e.map.addOverlay(s);var n=document.getElementsByClassName("overlay"),o=e;n[i].onclick=function(){console.log(t.grangeNumber),o.$router.push({name:"grangedetail",params:{id:t.grangeNumber}})}});else{var n=new a(new BMap.Point(this.farmhouseNum.longitude,this.farmhouseNum.latitude),this.farmhouseNum.villageName+this.farmhouseNum.count+"套",this.farmhouseNum.id);this.map.addOverlay(n)}var o=this;this.map.addEventListener("touchmove",function(t){o.map.enableDragging()}),this.map.addEventListener("touchend",function(t){o.map.disableDragging()}),this.map.disableDragging(),this.map.enableScrollWheelZoom(!0)},change:function(t){this.changeRed=t,0==t&&(this.landList,this.foodList=[],this.stayList=[],this.playList=[],this.setmap(),this.init()),1==t&&(this.landList=[],this.foodList,this.stayList=[],this.playList=[],this.setmap(),this.init()),2==t&&(this.landList=[],this.foodList=[],this.stayList,this.playList=[],this.setmap(),this.init()),3==t&&(this.landList=[],this.foodList=[],this.stayList=[],this.playList,this.setmap(),this.init())}},n=a("jkKj"),o=a.n(n),l={name:"mapDetail",props:{isapp:null},data:function(){return{title:"地图详情",isback:!0,changeRed:"0",icon:[{iconfont:"iconfont icon-meishi",name:"美食"},{iconfont:"iconfont icon-zhusu",name:"住宿"},{iconfont:"iconfont icon-jingdian1",name:"游玩"},{iconfont:"iconfont icon-yiliao",name:"医疗"},{iconfont:"iconfont icon-jiaotong",name:"交通"}],landList:[],foodList:[],stayList:[],playList:[],latitude:"",longitude:"",detail:""}},components:{Header:i.a,BMap:o.a},methods:s,created:function(){this.init()}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"mapDetail"}},[t.isapp?t._e():i("div",{staticClass:"topBar"},[i("Header",{attrs:{title:t.title,isback:t.isback}})],1),t._v(" "),i("div",{staticClass:"top"},t._l(t.icon,function(e,a){return i("div",{staticClass:"icon",class:{orage:t.changeRed==a},on:{click:function(e){t.change(a)}}},[i("div",{class:e.iconfont}),t._v(" "),i("p",[t._v(t._s(e.name))])])})),t._v(" "),i("div",{staticClass:"maparea"},[i("div",{attrs:{id:"app"}},[i("div",{ref:"allmap",attrs:{id:"allmap"}}),t._v(" "),i("router-view")],1)]),t._v(" "),i("div",{staticClass:"position clear"},[i("div",{staticClass:"left"},[i("p",[t._v(t._s(t.detail.villageName))]),t._v(" "),i("p",{staticClass:"van-ellipsis"},[i("i",{staticClass:"iconfont icon-dizhi"}),t._v("\n        "+t._s(t.detail.villageName)+"\n      ")])]),t._v(" "),i("div",{staticClass:"right"},[i("a",{attrs:{target:"_self",href:"https://uri.amap.com/marker?position="+t.detail.longitude+","+t.detail.latitude+"&name="+t.detail.villageName}},[i("img",{attrs:{src:a("dfQ4")}})])])])])},staticRenderFns:[]};var d=a("VU/8")(l,r,!1,function(t){a("6UOi")},"data-v-5b79065c",null);e.default=d.exports},"6UOi":function(t,e){}});